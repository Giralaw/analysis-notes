%% LaTeX2e file `aux-to-subdir.sty'
%% generated by the `filecontents' environment
%% from source `bassmaster' on 2023/04/22.
%%

\RequirePackage{etoolbox}

\newcommand\DeclareAuxDir[1]{\gdef\AuxDir{#1}}

\let\AuxDir\@empty

% \document can't be patched using etoolbox so this is done manually here
% regexpatch would work but I have to run, so this is the direct version for now

\def\document{\endgroup
  \ifx\@unusedoptionlist\@empty\else
    \@latex@warning@no@line{Unused global option(s):^^J%
            \@spaces[\@unusedoptionlist]}%
  \fi
  \@colht\textheight
  \@colroom\textheight \vsize\textheight
  \columnwidth\textwidth
  \@clubpenalty\clubpenalty
  \if@twocolumn
    \advance\columnwidth -\columnsep
    \divide\columnwidth\tw@ \hsize\columnwidth \@firstcolumntrue
  \fi
  \hsize\columnwidth \linewidth\hsize
  \begingroup\@floatplacement\@dblfloatplacement
    \makeatletter\let\@writefile\@gobbletwo
    \global \let \@multiplelabels \relax
    \@input{\AuxDir\jobname.aux}%
  \endgroup
  \if@filesw
    \immediate\openout\@mainaux\AuxDir\jobname.aux
    \immediate\write\@mainaux{\relax}%
  \fi
  \process@table
  \let\glb@currsize\@empty  %% Force math initialization.
  \normalsize
  \everypar{}%
  \ifx\normalsfcodes\@empty
    \ifnum\sfcode`\.=\@m
      \let\normalsfcodes\frenchspacing
    \else
      \let\normalsfcodes\nonfrenchspacing
    \fi
  \fi
  \@noskipsecfalse
  \let \@refundefined \relax
  \let\AtBeginDocument\@firstofone
  \@begindocumenthook
  \ifdim\topskip<1sp\global\topskip 1sp\relax\fi
  \global\@maxdepth\maxdepth
  \global\let\@begindocumenthook\@undefined
  \ifx\@listfiles\@undefined
    \global\let\@filelist\relax
    \global\let\@addtofilelist\@gobble
  \fi
  \gdef\do##1{\global\let ##1\@notprerr}%
  \@preamblecmds
  \global\let \@nodocument \relax
  \global\let\do\noexpand
  \ignorespaces}


\patchcmd{\@include}
  {#1.aux}
  {\AuxDir#1.aux}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}

\patchcmd{\@include}
  {\@partaux #1.aux}
  {\@partaux \AuxDir#1.aux}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}


\patchcmd{\@starttoc}
  {\jobname}
  {\AuxDir\jobname}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}

\patchcmd{\@starttoc}
  {\endcsname \jobname}
  {\endcsname \AuxDir\jobname}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}

\patchcmd{\enddocument}
  {\jobname}
  {\AuxDir\jobname}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}

\patchcmd{\makeindex}
  {\jobname}
  {\AuxDir\jobname}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}

\patchcmd{\makeglossary}
  {\jobname}
  {\AuxDir\jobname}
  {\typeout{*** SUCCESS ***}}{\typeout{*** FAIL ***}}

% one could also patch \bibliography to load the .bbl file from the dir but I consider a .bbl more as part of a doc
% so not done

 
